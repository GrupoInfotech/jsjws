/*! jws-1.0 (c) 2012 Kenji Urushima | kjur.github.com/jsjws/license
 */
function _getSignatureInputByString(b,a){return stob64u(b)+"."+stob64u(a)}function _getHashBySignatureInput(c,b){var a=_RSASIGN_HASHHEXFUNC[b];if(a==null){throw"hash function not defined in jsrsasign: "+b}return a(c)}function _jws_verifySignature(g,d,a,e,c){var f=_getSignatureInputByString(g,d);var b=parseBigInt(a,16);return _rsasign_verifySignatureWithArgs(f,b,e,c)}function _jws_getEncodedSignatureValueFromJWS(a){if(a.match(/^[^.]+\.[^.]+\.([^.]+)$/)==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}return RegExp.$1}function _jws_verifyJWSByNE(d,f,j){if(d.match(/^([^.]+)\.([^.]+)\.([^.]+)$/)==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}var g=RegExp.$1;var b=RegExp.$2;var h=RegExp.$3;var k=g+"."+b;this.parsedJWS={};this.parsedJWS.headB64U=g;this.parsedJWS.payloadB64U=b;this.parsedJWS.sigvalB64U=h;this.parsedJWS.si=k;var e=b64utohex(h);var c=parseBigInt(e,16);this.parsedJWS.sigvalH=e;var a=b64utos(g);var i=b64utos(b);this.parsedJWS.headS=a;this.parsedJWS.payloadS=i;if(!this.isSafeJSONString(a)){throw"malformed JSON string for JWS Head: "+a}return _rsasign_verifySignatureWithArgs(k,c,f,j)}function _jws_getHashAlgFromHead(d){var b=jsonParse(d);var c=b.alg;var a="";if(c!="RS256"&&c!="RS512"){throw"JWS signature algorithm not supported: "+c}if(c=="RS256"){a="sha256"}if(c=="RS512"){a="sha512"}return a}function _jws_generateSignatureValueBySI_NED(a,f,i,c,g,h){var d=new RSAKey();d.setPrivate(c,g,h);var b=_jws_getHashAlgFromHead(a);var e=d.signString(i,b);return e}function _jws_generateSignatureValueByNED(f,c,e,b,d){var a=_getSignatureInputByString(f,c);return _jws_generateSignatureValueBySI_NED(f,c,a,e,b,d)}function _jws_generateJWSByNED(h,d,g,c,f){if(!this.isSafeJSONString(h)){throw"JWS Head is not safe JSON string: "+h}var b=_getSignatureInputByString(h,d);var e=_jws_generateSignatureValueBySI_NED(h,d,b,g,c,f);var a=hextob64u(e);return b+"."+a}function _jws_isSafeJSONString(b){var c=null;try{c=jsonParse(b);if(typeof c!="object"){return 0}if(c.constructor===Array){return 0}return 1}catch(a){return 0}}function JWS(){}JWS.prototype.isSafeJSONString=_jws_isSafeJSONString;JWS.prototype.getEncodedSignatureValueFromJWS=_jws_getEncodedSignatureValueFromJWS;JWS.prototype.generateJWSByNED=_jws_generateJWSByNED;JWS.prototype.verifyJWSByNE=_jws_verifyJWSByNE;